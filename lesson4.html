<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>第4課：單字朗讀練習（依PDF順序修正版）</title>
  <style>
    body {
      font-family: 'Arial', 'Hiragino Kaku Gothic ProN', sans-serif;
      background-color: #fff0f5;
      color: #333;
      padding: 2rem;
    }
    header {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 1rem;
      align-items: center;
      margin-bottom: .8rem;
    }
    h1 {
      color: #d26fa0;
      font-size: 2rem;
      margin: 0;
    }
    .controls {
      display: flex; flex-wrap: wrap; gap: .6rem .8rem; align-items: center; justify-content: flex-end;
    }
    .pill, .seg {
      background: #fff; border: 1px solid #f0cde3; box-shadow: 0 0 8px #e3a5c7; color: #c04583;
    }
    .pill {
      display: inline-flex; align-items: center; gap: .5rem; border-radius: 999px; padding: .35rem .7rem; font-size: .9rem; user-select: none;
    }
    .pill input[type="checkbox"] {
      width: 46px; height: 24px; appearance: none; outline: none; background: #f8d8e9; border-radius: 999px; position: relative; cursor: pointer; transition: background .2s ease;
    }
    .pill input[type="checkbox"]::after {
      content: ""; position: absolute; width: 20px; height: 20px; top: 2px; left: 2px; background: #fff; border-radius: 50%; box-shadow: 0 1px 4px rgba(0,0,0,.2); transition: left .2s ease;
    }
    .pill input[type="checkbox"]:checked { background: #ffaad4; }
    .pill input[type="checkbox"]:checked::after { left: 24px; }

    .search { border-radius: 999px; padding: .4rem .8rem; display: inline-flex; align-items: center; gap: .5rem; }
    .search input { border: none; outline: none; background: transparent; min-width: 12rem; color: #333; }

    .sliders { display: inline-flex; gap: .8rem; align-items: center; flex-wrap: wrap; border-radius: 999px; padding: .4rem .8rem; font-size: .9rem; }
    .sliders label { display: flex; align-items: center; gap: .4rem; }
    .sliders input[type="range"] { width: 120px; }

    .seg { display: inline-flex; border-radius: 999px; overflow: hidden; }
    .seg button {
      border: none; background: transparent; padding: .45rem .9rem; cursor: pointer; color: #c04583; font-weight: 600;
    }
    .seg button + button { border-left: 1px solid #f0cde3; }
    .seg button.active { background: #ffaad4; color: #fff; }

    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff; border-radius: 12px; overflow: hidden; box-shadow: 0 0 12px #e3a5c7; margin-top: .6rem;
    }
    th, td {
      padding: 0.8rem; text-align: left; border-bottom: 1px solid #f0cde3; vertical-align: top;
    }
    th { background-color: #f8d8e9; color: #c04583; }
    td.jp:hover { cursor: pointer; background-color: #ffeaf5; }

    /* 假名切換：加上 .hide-kana 隱藏所有 <rt> */
    .hide-kana rt { display: none; }

    /* 單向練習模式：隱藏中/日欄位 */
    .mode-cn .cn-col { display: none; } /* 日→中（先看日文）：隱中文欄 */
    .mode-jp .jp-col { display: none; } /* 中→日（先看中文）：隱日文欄 */

    .button-home { margin-top: 2rem; text-align: center; }
    .button-home a {
      background-color: #ffaad4; color: white; padding: 0.8rem 1.5rem; text-decoration: none; border-radius: 20px; font-weight: bold; box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .button-home a:hover { background-color: #f98fc3; }

    ruby { ruby-position: under; }
  </style>
</head>
<body>
  <header>
    <h1>📘 第4課：單字＋例句朗讀練習（依PDF順序）</h1>
    <div class="controls">
      <label class="search pill" title="輸入以即時篩選（日/中皆可）">
        🔎
        <input id="searchInput" type="text" placeholder="搜尋單字/意思/例句…" />
      </label>
      <label class="pill" title="切換顯示/隱藏假名（ふりがな）">
        假名
        <input id="kanaToggle" type="checkbox" />
      </label>
      <div class="sliders pill" title="調整朗讀速度與音量">
        <label>速度 <input id="rate" type="range" min="0.6" max="1.6" step="0.1" value="1" /></label>
        <label>音量 <input id="volume" type="range" min="0" max="1" step="0.05" value="1" /></label>
      </div>
      <div class="seg" id="modeSeg" role="tablist" aria-label="練習模式">
        <button type="button" data-mode="both"  class="active" aria-selected="true">顯示全部</button>
        <button type="button" data-mode="cn"    aria-selected="false">日→中（隱中文）</button>
        <button type="button" data-mode="jp"    aria-selected="false">中→日（隱日文）</button>
      </div>
    </div>
  </header>

  <table id="vocabTable">
    <tr>
      <th class="jp-col">單字（日文）</th>
      <th class="cn-col">中文意思</th>
      <th class="jp-col">例句（日文）</th>
      <th class="cn-col">中文翻譯</th>
    </tr>

    <!-- 第一段（動詞＋場所＋時間基本） -->
    <tr><td class="jp jp-col" onclick="speakJP('おきます')"><ruby><rb>起</rb><rt>お</rt></ruby>きます</td><td class="cn-col">起床</td><td class="jp jp-col" onclick="speakJP('わたしは 6じに おきます。')">わたしは 6じに <ruby><rb>起</rb><rt>お</rt></ruby>きます。</td><td class="cn-col">我六點起床。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('ねます')"><ruby><rb>寝</rb><rt>ね</rt></ruby>ます</td><td class="cn-col">睡覺</td><td class="jp jp-col" onclick="speakJP('11じに ねます。')">11じに <ruby><rb>寝</rb><rt>ね</rt></ruby>ます。</td><td class="cn-col">十一點睡覺。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('はたらきます')"><ruby><rb>働</rb><rt>はたら</rt></ruby>きます</td><td class="cn-col">工作</td><td class="jp jp-col" onclick="speakJP('まいにち はたらきます。')">まいにち <ruby><rb>働</rb><rt>はたら</rt></ruby>きます。</td><td class="cn-col">每天工作。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('やすみます')"><ruby><rb>休</rb><rt>やす</rt></ruby>みます</td><td class="cn-col">休息</td><td class="jp jp-col" onclick="speakJP('きょうは やすみます。')">きょうは <ruby><rb>休</rb><rt>やす</rt></ruby>みます。</td><td class="cn-col">今天休息。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('べんきょうします')"><ruby><rb>勉強</rb><rt>べんきょう</rt></ruby>します</td><td class="cn-col">念書</td><td class="jp jp-col" onclick="speakJP('にほんごを べんきょうします。')"><ruby><rb>日本語</rb><rt>にほんご</rt></ruby>を <ruby><rb>勉強</rb><rt>べんきょう</rt></ruby>します。</td><td class="cn-col">學習日文。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('おわります')"><ruby><rb>終</rb><rt>お</rt></ruby>わります</td><td class="cn-col">結束</td><td class="jp jp-col" onclick="speakJP('5じに おわります。')">5じに <ruby><rb>終</rb><rt>お</rt></ruby>わります。</td><td class="cn-col">五點結束。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('デパート')">デパート</td><td class="cn-col">百貨公司</td><td class="jp jp-col" onclick="speakJP('デパートは 10じに あきます。')">デパートは 10じに あきます。</td><td class="cn-col">百貨公司十點開門。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('ぎんこう')"><ruby><rb>銀行</rb><rt>ぎんこう</rt></ruby></td><td class="cn-col">銀行</td><td class="jp jp-col" onclick="speakJP('ぎんこうは 3じに しまります。')"><ruby><rb>銀行</rb><rt>ぎんこう</rt></ruby>は 3じに しまります。</td><td class="cn-col">銀行三點關門。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('ゆうびんきょく')"><ruby><rb>郵便局</rb><rt>ゆうびんきょく</rt></ruby></td><td class="cn-col">郵局</td><td class="jp jp-col" onclick="speakJP('ゆうびんきょくへ いきます。')"><ruby><rb>郵便局</rb><rt>ゆうびんきょく</rt></ruby>へ いきます。</td><td class="cn-col">去郵局。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('としょかん')"><ruby><rb>図書館</rb><rt>としょかん</rt></ruby></td><td class="cn-col">圖書館</td><td class="jp jp-col" onclick="speakJP('としょかんで べんきょうします。')"><ruby><rb>図書館</rb><rt>としょかん</rt></ruby>で <ruby><rb>勉強</rb><rt>べんきょう</rt></ruby>します。</td><td class="cn-col">在圖書館學習。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('びじゅつかん')"><ruby><rb>美術館</rb><rt>びじゅつかん</rt></ruby></td><td class="cn-col">美術館</td><td class="jp jp-col" onclick="speakJP('びじゅつかんへ いきます。')"><ruby><rb>美術館</rb><rt>びじゅつかん</rt></ruby>へ いきます。</td><td class="cn-col">去美術館。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('いま')"><ruby><rb>今</rb><rt>いま</rt></ruby></td><td class="cn-col">現在</td><td class="jp jp-col" onclick="speakJP('いま なんじですか。')"><ruby><rb>今</rb><rt>いま</rt></ruby> なんじですか。</td><td class="cn-col">現在幾點？</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('～じ')">～<ruby><rb>時</rb><rt>じ</rt></ruby></td><td class="cn-col">～點</td><td class="jp jp-col" onclick="speakJP('8じに おきます。')">8<ruby><rb>時</rb><rt>じ</rt></ruby>に <ruby><rb>起</rb><rt>お</rt></ruby>きます。</td><td class="cn-col">八點起床。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('～ふん／～ぷん')">～<ruby><rb>分</rb><rt>ふん／ぷん</rt></ruby></td><td class="cn-col">～分</td><td class="jp jp-col" onclick="speakJP('6じ15ふんです。')">6じ15<ruby><rb>分</rb><rt>ふん</rt></ruby>です。</td><td class="cn-col">六點十五分。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('はん')"><ruby><rb>半</rb><rt>はん</rt></ruby></td><td class="cn-col">半</td><td class="jp jp-col" onclick="speakJP('7じはんです。')">7じ<ruby><rb>半</rb><rt>はん</rt></ruby>です。</td><td class="cn-col">七點半。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('なんじ')"><ruby><rb>何時</rb><rt>なんじ</rt></ruby></td><td class="cn-col">幾點</td><td class="jp jp-col" onclick="speakJP('なんじに おきますか。')"><ruby><rb>何時</rb><rt>なんじ</rt></ruby>に <ruby><rb>起</rb><rt>お</rt></ruby>きますか。</td><td class="cn-col">你幾點起床？</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('なんぷん')"><ruby><rb>何分</rb><rt>なんぷん</rt></ruby></td><td class="cn-col">幾分</td><td class="jp jp-col" onclick="speakJP('いま なんぷんですか。')"><ruby><rb>今</rb><rt>いま</rt></ruby> <ruby><rb>何分</rb><rt>なんぷん</rt></ruby>ですか。</td><td class="cn-col">現在幾分？</td></tr>

    <!-- 第二段（時間帶、日期、名詞） -->
    <tr><td class="jp jp-col" onclick="speakJP('ごぜん')"><ruby><rb>午前</rb><rt>ごぜん</rt></ruby></td><td class="cn-col">上午</td><td class="jp jp-col" onclick="speakJP('ごぜん8じに おきます。')"><ruby><rb>午前</rb><rt>ごぜん</rt></ruby>8じに <ruby><rb>起</rb><rt>お</rt></ruby>きます。</td><td class="cn-col">上午八點起床。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('ごご')"><ruby><rb>午後</rb><rt>ごご</rt></ruby></td><td class="cn-col">下午</td><td class="jp jp-col" onclick="speakJP('ごご3じに かえります。')"><ruby><rb>午後</rb><rt>ごご</rt></ruby>3じに かえります。</td><td class="cn-col">下午三點回家。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('あさ')"><ruby><rb>朝</rb><rt>あさ</rt></ruby></td><td class="cn-col">早上</td><td class="jp jp-col" onclick="speakJP('あさ ごはんを たべます。')"><ruby><rb>朝</rb><rt>あさ</rt></ruby> ごはんを たべます。</td><td class="cn-col">早上吃飯。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('ひる')"><ruby><rb>昼</rb><rt>ひる</rt></ruby></td><td class="cn-col">白天／中午</td><td class="jp jp-col" onclick="speakJP('ひる やすみます。')"><ruby><rb>昼</rb><rt>ひる</rt></ruby> やすみます。</td><td class="cn-col">白天休息。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('ばん／よる')"><ruby><rb>晩</rb><rt>ばん</rt></ruby>／<ruby><rb>夜</rb><rt>よる</rt></ruby></td><td class="cn-col">晚上</td><td class="jp jp-col" onclick="speakJP('ばん テレビを みます。')"><ruby><rb>晩</rb><rt>ばん</rt></ruby> テレビを みます。</td><td class="cn-col">晚上看電視。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('おととい')">おととい</td><td class="cn-col">前天</td><td class="jp jp-col" onclick="speakJP('おととい えいがを みました。')">おととい <ruby><rb>映画</rb><rt>えいが</rt></ruby>を みました。</td><td class="cn-col">前天看了電影。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('きのう')"><ruby><rb>昨日</rb><rt>きのう</rt></ruby></td><td class="cn-col">昨天</td><td class="jp jp-col" onclick="speakJP('きのう はたらきました。')"><ruby><rb>昨日</rb><rt>きのう</rt></ruby> <ruby><rb>働</rb><rt>はたら</rt></ruby>きました。</td><td class="cn-col">昨天工作了。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('きょう')"><ruby><rb>今日</rb><rt>きょう</rt></ruby></td><td class="cn-col">今天</td><td class="jp jp-col" onclick="speakJP('きょう やすみます。')"><ruby><rb>今日</rb><rt>きょう</rt></ruby> <ruby><rb>休</rb><rt>やす</rt></ruby>みます。</td><td class="cn-col">今天休息。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('あした')"><ruby><rb>明日</rb><rt>あした</rt></ruby></td><td class="cn-col">明天</td><td class="jp jp-col" onclick="speakJP('あした としょかんへ いきます。')"><ruby><rb>明日</rb><rt>あした</rt></ruby> <ruby><rb>図書館</rb><rt>としょかん</rt></ruby>へ いきます。</td><td class="cn-col">明天去圖書館。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('あさって')">あさって</td><td class="cn-col">後天</td><td class="jp jp-col" onclick="speakJP('あさって しけんが あります。')">あさって <ruby><rb>試験</rb><rt>しけん</rt></ruby>が あります。</td><td class="cn-col">後天有考試。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('けさ')"><ruby><rb>今朝</rb><rt>けさ</rt></ruby></td><td class="cn-col">今天早上</td><td class="jp jp-col" onclick="speakJP('けさ パンを たべました。')"><ruby><rb>今朝</rb><rt>けさ</rt></ruby> パンを たべました。</td><td class="cn-col">今天早上吃了麵包。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('こんばん')"><ruby><rb>今晩</rb><rt>こんばん</rt></ruby></td><td class="cn-col">今晚</td><td class="jp jp-col" onclick="speakJP('こんばん えいがを みます。')"><ruby><rb>今晩</rb><rt>こんばん</rt></ruby> <ruby><rb>映画</rb><rt>えいが</rt></ruby>を みます。</td><td class="cn-col">今晚看電影。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('やすみ')"><ruby><rb>休</rb><rt>やす</rt></ruby>み</td><td class="cn-col">休息、休假</td><td class="jp jp-col" onclick="speakJP('あしたは やすみです。')"><ruby><rb>明日</rb><rt>あした</rt></ruby>は <ruby><rb>休</rb><rt>やす</rt></ruby>みです。</td><td class="cn-col">明天是休假。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('ひるやすみ')"><ruby><rb>昼休</rb><rt>ひるやす</rt></ruby>み</td><td class="cn-col">午休</td><td class="jp jp-col" onclick="speakJP('ひるやすみに パンを たべます。')"><ruby><rb>昼休</rb><rt>ひるやす</rt></ruby>みに パンを たべます。</td><td class="cn-col">午休吃麵包。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('しけん')"><ruby><rb>試験</rb><rt>しけん</rt></ruby></td><td class="cn-col">考試</td><td class="jp jp-col" onclick="speakJP('らいしゅう しけんが あります。')">らいしゅう <ruby><rb>試験</rb><rt>しけん</rt></ruby>が あります。</td><td class="cn-col">下週有考試。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('かいぎ')"><ruby><rb>会議</rb><rt>かいぎ</rt></ruby></td><td class="cn-col">會議</td><td class="jp jp-col" onclick="speakJP('かいぎは ごご1じからです。')"><ruby><rb>会議</rb><rt>かいぎ</rt></ruby>は <ruby><rb>午後</rb><rt>ごご</rt></ruby>1じからです。</td><td class="cn-col">會議從下午一點開始。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('えいが')"><ruby><rb>映画</rb><rt>えいが</rt></ruby></td><td class="cn-col">電影</td><td class="jp jp-col" onclick="speakJP('きのう えいがを みました。')"><ruby><rb>昨日</rb><rt>きのう</rt></ruby> <ruby><rb>映画</rb><rt>えいが</rt></ruby>を みました。</td><td class="cn-col">昨天看了電影。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('まいあさ')"><ruby><rb>毎朝</rb><rt>まいあさ</rt></ruby></td><td class="cn-col">每天早上</td><td class="jp jp-col" onclick="speakJP('まいあさ コーヒーを のみます。')"><ruby><rb>毎朝</rb><rt>まいあさ</rt></ruby> コーヒーを のみます。</td><td class="cn-col">每天早上喝咖啡。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('まいばん')"><ruby><rb>毎晩</rb><rt>まいばん</rt></ruby></td><td class="cn-col">每天晚上</td><td class="jp jp-col" onclick="speakJP('まいばん テレビを みます。')"><ruby><rb>毎晩</rb><rt>まいばん</rt></ruby> テレビを みます。</td><td class="cn-col">每天晚上看電視。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('まいにち')"><ruby><rb>毎日</rb><rt>まいにち</rt></ruby></td><td class="cn-col">每天</td><td class="jp jp-col" onclick="speakJP('まいにち はたらきます。')"><ruby><rb>毎日</rb><rt>まいにち</rt></ruby> <ruby><rb>働</rb><rt>はたら</rt></ruby>きます。</td><td class="cn-col">每天工作。</td></tr>

    <!-- 第三段（星期、助詞、其他） -->
    <tr><td class="jp jp-col" onclick="speakJP('げつようび')"><ruby><rb>月曜日</rb><rt>げつようび</rt></ruby></td><td class="cn-col">星期一</td><td class="jp jp-col" onclick="speakJP('げつようびから はたらきます。')"><ruby><rb>月曜日</rb><rt>げつようび</rt></ruby>から <ruby><rb>働</rb><rt>はたら</rt></ruby>きます。</td><td class="cn-col">從星期一開始工作。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('かようび')"><ruby><rb>火曜日</rb><rt>かようび</rt></ruby></td><td class="cn-col">星期二</td><td class="jp jp-col" onclick="speakJP('かようびに しけんが あります。')"><ruby><rb>火曜日</rb><rt>かようび</rt></ruby>に <ruby><rb>試験</rb><rt>しけん</rt></ruby>が あります。</td><td class="cn-col">星期二有考試。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('すいようび')"><ruby><rb>水曜日</rb><rt>すいようび</rt></ruby></td><td class="cn-col">星期三</td><td class="jp jp-col" onclick="speakJP('すいようびに えいがを みます。')"><ruby><rb>水曜日</rb><rt>すいようび</rt></ruby>に <ruby><rb>映画</rb><rt>えいが</rt></ruby>を みます。</td><td class="cn-col">星期三看電影。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('もくようび')"><ruby><rb>木曜日</rb><rt>もくようび</rt></ruby></td><td class="cn-col">星期四</td><td class="jp jp-col" onclick="speakJP('もくようびは やすみです。')"><ruby><rb>木曜日</rb><rt>もくようび</rt></ruby>は <ruby><rb>休</rb><rt>やす</rt></ruby>みです。</td><td class="cn-col">星期四休假。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('きんようび')"><ruby><rb>金曜日</rb><rt>きんようび</rt></ruby></td><td class="cn-col">星期五</td><td class="jp jp-col" onclick="speakJP('きんようびに かいぎが あります。')"><ruby><rb>金曜日</rb><rt>きんようび</rt></ruby>に <ruby><rb>会議</rb><rt>かいぎ</rt></ruby>が あります。</td><td class="cn-col">星期五有會議。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('どようび')"><ruby><rb>土曜日</rb><rt>どようび</rt></ruby></td><td class="cn-col">星期六</td><td class="jp jp-col" onclick="speakJP('どようびに アルバイトを します。')"><ruby><rb>土曜日</rb><rt>どようび</rt></ruby>に アルバイトを します。</td><td class="cn-col">星期六打工。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('にちようび')"><ruby><rb>日曜日</rb><rt>にちようび</rt></ruby></td><td class="cn-col">星期日</td><td class="jp jp-col" onclick="speakJP('にちようびは やすみです。')"><ruby><rb>日曜日</rb><rt>にちようび</rt></ruby>は <ruby><rb>休</rb><rt>やす</rt></ruby>みです。</td><td class="cn-col">星期日休假。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('なんようび')"><ruby><rb>何曜日</rb><rt>なんようび</rt></ruby></td><td class="cn-col">星期幾</td><td class="jp jp-col" onclick="speakJP('きょうは なんようびですか。')">きょうは <ruby><rb>何曜日</rb><rt>なんようび</rt></ruby>ですか。</td><td class="cn-col">今天星期幾？</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('〜から')">〜から</td><td class="cn-col">從〜</td><td class="jp jp-col" onclick="speakJP('9じから べんきょうします。')">9じから <ruby><rb>勉強</rb><rt>べんきょう</rt></ruby>します。</td><td class="cn-col">從九點開始讀書。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('〜まで')">〜まで</td><td class="cn-col">到〜</td><td class="jp jp-col" onclick="speakJP('5じまで はたらきます。')">5じまで <ruby><rb>働</rb><rt>はたら</rt></ruby>きます。</td><td class="cn-col">工作到五點。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('〜と〜')">〜と〜</td><td class="cn-col">〜和〜</td><td class="jp jp-col" onclick="speakJP('わたしと たなかさん。')">わたしと たなかさん。</td><td class="cn-col">我和田中先生。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('ばんごう')"><ruby><rb>番号</rb><rt>ばんごう</rt></ruby></td><td class="cn-col">號碼</td><td class="jp jp-col" onclick="speakJP('でんわの ばんごうは なんばんですか。')"><ruby><rb>電話</rb><rt>でんわ</rt></ruby>の <ruby><rb>番号</rb><rt>ばんごう</rt></ruby>は <ruby><rb>何番</rb><rt>なんばん</rt></ruby>ですか。</td><td class="cn-col">電話號碼是幾號？</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('なんばん')"><ruby><rb>何番</rb><rt>なんばん</rt></ruby></td><td class="cn-col">幾號</td><td class="jp jp-col" onclick="speakJP('きっぷは なんばんですか。')">きっぷは <ruby><rb>何番</rb><rt>なんばん</rt></ruby>ですか。</td><td class="cn-col">票是幾號？</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('そちら')">そちら</td><td class="cn-col">那邊、您那邊</td><td class="jp jp-col" onclick="speakJP('そちらは いま なんじですか。')">そちらは <ruby><rb>今</rb><rt>いま</rt></ruby> なんじですか。</td><td class="cn-col">您那邊現在幾點？</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('たいへんですね')"><ruby><rb>大変</rb><rt>たいへん</rt></ruby>ですね。</td><td class="cn-col">真是辛苦啊。</td><td class="jp jp-col" onclick="speakJP('まいにち ざんぎょう？ たいへんですね。')">まいにち <ruby><rb>残業</rb><rt>ざんぎょう</rt></ruby>？ <ruby><rb>大変</rb><rt>たいへん</rt></ruby>ですね。</td><td class="cn-col">每天加班？真辛苦啊。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('ニューヨーク')">ニューヨーク</td><td class="cn-col">紐約</td><td class="jp jp-col" onclick="speakJP('ニューヨークへ いきます。')">ニューヨークへ いきます。</td><td class="cn-col">要去紐約。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('ペキン')">ペキン</td><td class="cn-col">北京</td><td class="jp jp-col" onclick="speakJP('ペキンから きました。')">ペキンから きました。</td><td class="cn-col">從北京來。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('ロサンゼルス')">ロサンゼルス</td><td class="cn-col">洛杉磯</td><td class="jp jp-col" onclick="speakJP('ロサンゼルスへ りょこうします。')">ロサンゼルスへ りょこうします。</td><td class="cn-col">去洛杉磯旅行。</td></tr>
    <tr><td class="jp jp-col" onclick="speakJP('ロンドン')">ロンドン</td><td class="cn-col">倫敦</td><td class="jp jp-col" onclick="speakJP('ロンドンに すんでいます。')">ロンドンに すんでいます。</td><td class="cn-col">住在倫敦。</td></tr>
  </table>

  <div class="button-home">
    <a href="index.html">回首頁 🏠</a>
  </div>

  <script>
    let voicesLoaded = false;

    // 偏好 keys（沿用全站 TTS；練習模式為第4課獨立 key）
    const KANA_KEY = 'showKana';
    const RATE_KEY = 'ttsRate';
    const VOL_KEY  = 'ttsVolume';
    const MODE_KEY = 'practiceMode4';

    function getRate(){ const r = parseFloat(localStorage.getItem(RATE_KEY) ?? '1'); return isNaN(r)?1:r; }
    function getVolume(){ const v = parseFloat(localStorage.getItem(VOL_KEY) ?? '1'); return isNaN(v)?1:v; }

    function speakJP(text) {
      if (!voicesLoaded) {
        window.speechSynthesis.onvoiceschanged = () => { voicesLoaded = true; speakJP(text); };
        speechSynthesis.getVoices();
        return;
      }
      // 清除前一段朗讀，避免重疊
      speechSynthesis.cancel();

      const u = new SpeechSynthesisUtterance(text);
      u.lang = 'ja-JP';
      u.rate = getRate();
      u.volume = getVolume();
      const jpVoice = speechSynthesis.getVoices().find(v => v.lang === 'ja-JP');
      if (jpVoice) u.voice = jpVoice;

      speechSynthesis.speak(u);
    }

    // 假名切換
    function applyKanaPreference(show) {
      document.body.classList.toggle('hide-kana', !show);
      const toggle = document.getElementById('kanaToggle');
      if (toggle) toggle.checked = show;
    }

    // 練習模式（顯示全部 / 日→中 / 中→日）
    function applyPracticeMode(mode) {
      document.body.classList.remove('mode-cn','mode-jp');
      if (mode === 'cn') document.body.classList.add('mode-cn');
      if (mode === 'jp') document.body.classList.add('mode-jp');
      document.querySelectorAll('#modeSeg button').forEach(btn => {
        const active = btn.dataset.mode === mode;
        btn.classList.toggle('active', active);
        btn.setAttribute('aria-selected', String(active));
      });
    }

    // 即時搜尋
    function setupSearch() {
      const input = document.getElementById('searchInput');
      const rows = Array.from(document.querySelectorAll('#vocabTable tr')).slice(1);
      input.addEventListener('input', () => {
        const q = input.value.trim().toLowerCase();
        rows.forEach(tr => {
          const hit = tr.textContent.toLowerCase().includes(q);
          tr.style.display = hit ? '' : 'none';
        });
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      // 語音初始化
      const checkVoices = () => {
        if (speechSynthesis.getVoices().length > 0) { voicesLoaded = true; }
        else { setTimeout(checkVoices, 120); }
      };
      checkVoices();

      // 假名偏好
      const savedKana = localStorage.getItem(KANA_KEY);
      const showKana = savedKana === null ? true : savedKana === 'true';
      applyKanaPreference(showKana);
      document.getElementById('kanaToggle').addEventListener('change', e => {
        const show = e.target.checked;
        applyKanaPreference(show);
        localStorage.setItem(KANA_KEY, String(show));
      });

      // 朗讀偏好
      const rateEl = document.getElementById('rate');
      const volEl  = document.getElementById('volume');
      rateEl.value = String(getRate());
      volEl.value  = String(getVolume());
      rateEl.addEventListener('input', () => localStorage.setItem(RATE_KEY, rateEl.value));
      volEl.addEventListener('input',  () => localStorage.setItem(VOL_KEY,  volEl.value));

      // 練習模式
      const savedMode = localStorage.getItem(MODE_KEY) ?? 'both';
      applyPracticeMode(savedMode);
      document.querySelectorAll('#modeSeg button').forEach(btn => {
        btn.addEventListener('click', () => {
          const mode = btn.dataset.mode;
          applyPracticeMode(mode);
          localStorage.setItem(MODE_KEY, mode);
        });
      });

      // 搜尋
      setupSearch();
    });
  </script>
</body>
</html>

