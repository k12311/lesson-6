<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>第8課：單字朗讀練習</title>
  <style>
    body {
      font-family: 'Arial', 'Hiragino Kaku Gothic ProN', sans-serif;
      background-color: #fff0f5;
      color: #333;
      padding: 2rem;
    }
    header {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 1rem;
      align-items: center;
      margin-bottom: .8rem;
    }
    h1 {
      color: #d26fa0;
      font-size: 2rem;
      margin: 0;
    }
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: .6rem .8rem;
      align-items: center;
      justify-content: flex-end;
    }
    .pill, .seg {
      background: #fff;
      border: 1px solid #f0cde3;
      box-shadow: 0 0 8px #e3a5c7;
      color: #c04583;
    }
    .pill {
      display: inline-flex; align-items: center; gap: .5rem;
      border-radius: 999px; padding: .35rem .7rem; font-size: .9rem; user-select: none;
    }
    .pill input[type="checkbox"] {
      width: 46px; height: 24px; appearance: none; outline: none;
      background: #f8d8e9; border-radius: 999px; position: relative; cursor: pointer;
      transition: background .2s ease;
    }
    .pill input[type="checkbox"]::after {
      content: ""; position: absolute; width: 20px; height: 20px; top: 2px; left: 2px;
      background: #fff; border-radius: 50%; box-shadow: 0 1px 4px rgba(0,0,0,.2);
      transition: left .2s ease;
    }
    .pill input[type="checkbox"]:checked { background: #ffaad4; }
    .pill input[type="checkbox"]:checked::after { left: 24px; }

    .search {
      border-radius: 999px; padding: .4rem .8rem;
      display: inline-flex; align-items: center; gap: .5rem;
    }
    .search input { border: none; outline: none; background: transparent; min-width: 12rem; color: #333; }

    .sliders {
      display: inline-flex; gap: .8rem; align-items: center; flex-wrap: wrap;
      border-radius: 999px; padding: .4rem .8rem; font-size: .9rem;
    }
    .sliders label { display: flex; align-items: center; gap: .4rem; }
    .sliders input[type="range"] { width: 120px; }

    /* Segmented control */
    .seg {
      display: inline-flex; border-radius: 999px; overflow: hidden;
    }
    .seg button {
      border: none; background: transparent; padding: .45rem .9rem; cursor: pointer;
      color: #c04583; font-weight: 600;
    }
    .seg button + button { border-left: 1px solid #f0cde3; }
    .seg button.active { background: #ffaad4; color: #fff; }

    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 0 12px #e3a5c7;
      margin-top: .6rem;
    }
    th, td {
      padding: 0.8rem;
      text-align: left;
      border-bottom: 1px solid #f0cde3;
      vertical-align: top;
    }
    th { background-color: #f8d8e9; color: #c04583; }
    td.jp:hover { cursor: pointer; background-color: #ffeaf5; }

    /* 假名切換：加上 .hide-kana 隱藏所有 <rt> */
    .hide-kana rt { display: none; }

    /* 單向練習模式：隱藏中/日欄位（th、td都有 class） */
    .mode-cn .cn-col { display: none; } /* 日→中：隱藏中文欄 */
    .mode-jp .jp-col { display: none; } /* 中→日：隱藏日文欄 */

    .button-home { margin-top: 2rem; text-align: center; }
    .button-home a {
      background-color: #ffaad4; color: white; padding: 0.8rem 1.5rem;
      text-decoration: none; border-radius: 20px; font-weight: bold;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .button-home a:hover { background-color: #f98fc3; }

    ruby { ruby-position: under; }
  </style>
</head>
<body>
  <header>
    <h1>📘 第8課：單字＋例句朗讀練習</h1>
    <div class="controls">
      <label class="search pill" title="輸入以即時篩選（日/中皆可）">
        🔎
        <input id="searchInput" type="text" placeholder="搜尋單字/意思/例句…" />
      </label>

      <!-- 假名切換 -->
      <label class="pill" title="切換顯示/隱藏假名（ふりがな）">
        假名
        <input id="kanaToggle" type="checkbox" />
      </label>

      <!-- 朗讀控制 -->
      <div class="sliders pill" title="調整朗讀速度與音量">
        <label>速度 <input id="rate" type="range" min="0.6" max="1.6" step="0.1" value="1" /></label>
        <label>音量 <input id="volume" type="range" min="0" max="1" step="0.05" value="1" /></label>
      </div>

      <!-- 單向練習模式 Segmented -->
      <div class="seg" id="modeSeg" role="tablist" aria-label="練習模式">
        <button type="button" data-mode="both"  class="active" aria-selected="true">顯示全部</button>
        <button type="button" data-mode="cn"    aria-selected="false">日→中（隱藏中文）</button>
        <button type="button" data-mode="jp"    aria-selected="false">中→日（隱藏日文）</button>
      </div>
    </div>
  </header>

  <table id="vocabTable">
    <tr>
      <th class="jp-col">單字（日文）</th>
      <th class="cn-col">中文意思</th>
      <th class="jp-col">例句（日文）</th>
      <th class="cn-col">中文翻譯</th>
    </tr>

    <!-- 以下內容為你提供的第8課，已保留/整合 ruby 與 onclick。為了模式切換，日文欄加上 jp-col，中文欄加上 cn-col。 -->

    <tr>
      <td class="jp jp-col" onclick="speakJP('ハンサム')">ハンサム</td>
      <td class="cn-col">英俊</td>
      <td class="jp jp-col" onclick="speakJP('かれは ハンサムです。')">かれは ハンサムです。</td>
      <td class="cn-col">他很英俊。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('きれい')">きれい</td>
      <td class="cn-col">漂亮</td>
      <td class="jp jp-col" onclick="speakJP('にわは きれいです。')">にわは きれいです。</td>
      <td class="cn-col">庭院很漂亮。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('しずか')"><ruby><rb>静</rb><rt>しず</rt></ruby>か（<span>な</span>）</td>
      <td class="cn-col">安靜</td>
      <td class="jp jp-col" onclick="speakJP('この へやは しずかです。')">この へやは しずかです。</td>
      <td class="cn-col">這個房間很安靜。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('ゆうめい')"><ruby><rb>有名</rb><rt>ゆうめい</rt></ruby>（<span>な</span>）</td>
      <td class="cn-col">有名</td>
      <td class="jp jp-col" onclick="speakJP('この がっこうは ゆうめいです。')">この がっこうは ゆうめいです。</td>
      <td class="cn-col">這所學校很有名。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('しんせつ')"><ruby><rb>親切</rb><rt>しんせつ</rt></ruby>（<span>な</span>）</td>
      <td class="cn-col">親切</td>
      <td class="jp jp-col" onclick="speakJP('せんせいは しんせつです。')">せんせいは しんせつです。</td>
      <td class="cn-col">老師很親切。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('げんき')"><ruby><rb>元気</rb><rt>げんき</rt></ruby>（<span>な</span>）</td>
      <td class="cn-col">健康、有精神</td>
      <td class="jp jp-col" onclick="speakJP('かれは げんきです。')">かれは げんきです。</td>
      <td class="cn-col">他很有精神。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('ひま')"><ruby><rb>暇</rb><rt>ひま</rt></ruby>（<span>な</span>）</td>
      <td class="cn-col">有空</td>
      <td class="jp jp-col" onclick="speakJP('きょうは ひまです。')">きょうは ひまです。</td>
      <td class="cn-col">今天有空。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('べんり')"><ruby><rb>便利</rb><rt>べんり</rt></ruby>（<span>な</span>）</td>
      <td class="cn-col">方便</td>
      <td class="jp jp-col" onclick="speakJP('この でんしゃは べんりです。')">この でんしゃは べんりです。</td>
      <td class="cn-col">這列電車很方便。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('おおきい')"><ruby><rb>大</rb><rt>おお</rt></ruby>きい</td>
      <td class="cn-col">大</td>
      <td class="jp jp-col" onclick="speakJP('この いぬは おおきいです。')">この いぬは おおきいです。</td>
      <td class="cn-col">這隻狗很大。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('ちいさい')"><ruby><rb>小</rb><rt>ちい</rt></ruby>さい</td>
      <td class="cn-col">小</td>
      <td class="jp jp-col" onclick="speakJP('ちいさい こえで はなします。')">ちいさい こえで はなします。</td>
      <td class="cn-col">小聲地說話。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('あたらしい')"><ruby><rb>新</rb><rt>あたら</rt></ruby>しい</td>
      <td class="cn-col">新</td>
      <td class="jp jp-col" onclick="speakJP('あたらしい じてんしゃを かいました。')">あたらしい じてんしゃを かいました。</td>
      <td class="cn-col">買了新腳踏車。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('ふるい')"><ruby><rb>古</rb><rt>ふる</rt></ruby>い</td>
      <td class="cn-col">舊</td>
      <td class="jp jp-col" onclick="speakJP('ふるい たてものです。')">ふるい たてものです。</td>
      <td class="cn-col">是棟老建築。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('いい')"><ruby><rb>良</rb><rt>よ</rt></ruby>い（口語常說「いい」）</td>
      <td class="cn-col">好</td>
      <td class="jp jp-col" onclick="speakJP('この ほんは いいです。')">この ほんは いいです。</td>
      <td class="cn-col">這本書很好。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('わるい')"><ruby><rb>悪</rb><rt>わる</rt></ruby>い</td>
      <td class="cn-col">壞</td>
      <td class="jp jp-col" onclick="speakJP('てんきが わるいです。')">てんきが わるいです。</td>
      <td class="cn-col">天氣不好。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('あつい')"><ruby><rb>暑</rb><rt>あつ</rt></ruby>い／<ruby><rb>熱</rb><rt>あつ</rt></ruby>い</td>
      <td class="cn-col">熱（天氣／東西）</td>
      <td class="jp jp-col" onclick="speakJP('きょうは とても あついです。')">きょうは とても あついです。</td>
      <td class="cn-col">今天非常熱。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('さむい')"><ruby><rb>寒</rb><rt>さむ</rt></ruby>い</td>
      <td class="cn-col">冷（天氣）</td>
      <td class="jp jp-col" onclick="speakJP('さむい ふゆが きました。')">さむい ふゆが きました。</td>
      <td class="cn-col">寒冷的冬天到了。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('つめたい')"><ruby><rb>冷</rb><rt>つめ</rt></ruby>たい</td>
      <td class="cn-col">冰、涼</td>
      <td class="jp jp-col" onclick="speakJP('つめたい のみものが すきです。')">つめたい のみものが すきです。</td>
      <td class="cn-col">我喜歡冰的飲料。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('むずかしい')"><ruby><rb>難</rb><rt>むずか</rt></ruby>しい</td>
      <td class="cn-col">難</td>
      <td class="jp jp-col" onclick="speakJP('この しゅくだいは むずかしいです。')">この しゅくだいは むずかしいです。</td>
      <td class="cn-col">這份作業很難。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('やさしい')"><ruby><rb>易</rb><rt>やさ</rt></ruby>しい</td>
      <td class="cn-col">簡單</td>
      <td class="jp jp-col" onclick="speakJP('この テストは やさしいです。')">この テストは やさしいです。</td>
      <td class="cn-col">這個考試很簡單。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('たかい')"><ruby><rb>高</rb><rt>たか</rt></ruby>い</td>
      <td class="cn-col">貴、高</td>
      <td class="jp jp-col" onclick="speakJP('この ビルは とても たかいです。')">この ビルは とても たかいです。</td>
      <td class="cn-col">這棟大樓很高。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('やすい')"><ruby><rb>安</rb><rt>やす</rt></ruby>い</td>
      <td class="cn-col">便宜</td>
      <td class="jp jp-col" onclick="speakJP('この ほんは やすいです。')">この ほんは やすいです。</td>
      <td class="cn-col">這本書很便宜。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('ひくい')"><ruby><rb>低</rb><rt>ひく</rt></ruby>い</td>
      <td class="cn-col">低、矮</td>
      <td class="jp jp-col" onclick="speakJP('この いすは ひくいです。')">この いすは ひくいです。</td>
      <td class="cn-col">這張椅子很矮。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('しろい')"><ruby><rb>白</rb><rt>しろ</rt></ruby>い</td>
      <td class="cn-col">白色</td>
      <td class="jp jp-col" onclick="speakJP('しろい シャツを きます。')">しろい シャツを きます。</td>
      <td class="cn-col">穿白色襯衫。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('くろい')"><ruby><rb>黒</rb><rt>くろ</rt></ruby>い</td>
      <td class="cn-col">黑色</td>
      <td class="jp jp-col" onclick="speakJP('くろい くつを はきます。')">くろい くつを はきます。</td>
      <td class="cn-col">穿黑色鞋子。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('あかい')"><ruby><rb>赤</rb><rt>あか</rt></ruby>い</td>
      <td class="cn-col">紅色</td>
      <td class="jp jp-col" onclick="speakJP('あかい はなです。')">あかい はなです。</td>
      <td class="cn-col">是紅色的花。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('あおい')"><ruby><rb>青</rb><rt>あお</rt></ruby>い</td>
      <td class="cn-col">藍色</td>
      <td class="jp jp-col" onclick="speakJP('あおい そらが きれいです。')">あおい そらが きれいです。</td>
      <td class="cn-col">藍色的天空很漂亮。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('さくら')"><ruby><rb>桜</rb><rt>さくら</rt></ruby></td>
      <td class="cn-col">櫻花</td>
      <td class="jp jp-col" onclick="speakJP('こうえんに さくらが さきます。')">こうえんに さくらが さきます。</td>
      <td class="cn-col">公園裡櫻花綻放。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('まち')"><ruby><rb>町</rb><rt>まち</rt></ruby></td>
      <td class="cn-col">市鎮、街道</td>
      <td class="jp jp-col" onclick="speakJP('この まちは にぎやかです。')">この まちは にぎやかです。</td>
      <td class="cn-col">這個城市很熱鬧。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('たべもの')"><ruby><rb>食</rb><rt>た</rt></ruby>べ<ruby><rb>物</rb><rt>もの</rt></ruby></td>
      <td class="cn-col">食物</td>
      <td class="jp jp-col" onclick="speakJP('にほんの たべものが すきです。')">にほんの たべものが すきです。</td>
      <td class="cn-col">我喜歡日本食物。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('ところ')"><ruby><rb>所</rb><rt>ところ</rt></ruby></td>
      <td class="cn-col">地方</td>
      <td class="jp jp-col" onclick="speakJP('いい ところを しっていますか。')">いい ところを しっていますか。</td>
      <td class="cn-col">你知道好地方嗎？</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('りょう')"><ruby><rb>寮</rb><rt>りょう</rt></ruby></td>
      <td class="cn-col">宿舍</td>
      <td class="jp jp-col" onclick="speakJP('だいがくの りょうに すんでいます。')">だいがくの りょうに すんでいます。</td>
      <td class="cn-col">我住在大學宿舍。</td>
    </tr>

    <!-- 你新增的詞彙與表現 -->
    <tr>
      <td class="jp jp-col" onclick="speakJP('せいかつ')"><ruby><rb>生活</rb><rt>せいかつ</rt></ruby></td>
      <td class="cn-col">生活</td>
      <td class="jp jp-col" onclick="speakJP('にほんの せいかつに なれましたか。')">にほんの せいかつに なれましたか。</td>
      <td class="cn-col">習慣日本的生活了嗎？</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('おしごと')"><ruby><rb>お仕事</rb><rt>おしごと</rt></ruby></td>
      <td class="cn-col">工作（〜をします：工作）</td>
      <td class="jp jp-col" onclick="speakJP('おしごとは どうですか。')">おしごとは どうですか。</td>
      <td class="cn-col">工作怎麼樣？</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('どう')">どう</td>
      <td class="cn-col">怎麼樣</td>
      <td class="jp jp-col" onclick="speakJP('きょうの きぶんは どうですか。')">きょうの きぶんは どうですか。</td>
      <td class="cn-col">今天心情如何？</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('どんな')">どんな</td>
      <td class="cn-col">什麼樣的〜</td>
      <td class="jp jp-col" onclick="speakJP('どんな りょうりが すきですか。')">どんな りょうりが すきですか。</td>
      <td class="cn-col">你喜歡什麼樣的料理？</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('とても')">とても</td>
      <td class="cn-col">非常</td>
      <td class="jp jp-col" onclick="speakJP('この まちは とても きれいです。')">この まちは とても きれいです。</td>
      <td class="cn-col">這座城市非常漂亮。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('あまり')">あまり</td>
      <td class="cn-col">不太〜（否定句）</td>
      <td class="jp jp-col" onclick="speakJP('この えいがは あまり おもしろく ないです。')">この えいがは あまり おもしろく ないです。</td>
      <td class="cn-col">這部電影不太有趣。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('そして')">そして</td>
      <td class="cn-col">於是、然後</td>
      <td class="jp jp-col" onclick="speakJP('あさ ごはんを たべます。 そして、 がっこうへ いきます。')">あさ ごはんを たべます。 そして、 がっこうへ いきます。</td>
      <td class="cn-col">吃完早餐，然後去學校。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('いい てんきですが、 むしあついです。')">〜が、〜</td>
      <td class="cn-col">〜但是〜</td>
      <td class="jp jp-col" onclick="speakJP('いい てんきですが、 むしあついです。')">いい てんきですが、 むしあついです。</td>
      <td class="cn-col">天氣雖好但是很悶熱。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('もう いっぱい いかがですか。')">[〜、]もう 一杯 いかがですか。</td>
      <td class="cn-col">再來一杯（〜）怎麼樣？</td>
      <td class="jp jp-col" onclick="speakJP('もう いっぱい いかがですか。')">もう いっぱい いかがですか。</td>
      <td class="cn-col">再來一杯怎麼樣？</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('けっこうです。')">[いいえ、]けっこうです。</td>
      <td class="cn-col">[不，]不用了。</td>
      <td class="jp jp-col" onclick="speakJP('コーヒーは、 けっこうです。')">コーヒーは、 けっこうです。</td>
      <td class="cn-col">咖啡就不用了。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('もう 10じです ね。')">もう 〜です [ね]。</td>
      <td class="cn-col">已經〜了（呢）。</td>
      <td class="jp jp-col" onclick="speakJP('もう 10じです ね。')">もう 10じです ね。</td>
      <td class="cn-col">已經十點了呢。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('そろそろ しつれいします。')">そろそろ 失礼します。</td>
      <td class="cn-col">差不多該告辭了。</td>
      <td class="jp jp-col" onclick="speakJP('そろそろ しつれいします。')">そろそろ しつれいします。</td>
      <td class="cn-col">差不多該告辭了。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('いいえ、 だいじょうぶです。')">いいえ。</td>
      <td class="cn-col">不、沒什麼。</td>
      <td class="jp jp-col" onclick="speakJP('いいえ、 だいじょうぶです。')">いいえ、 だいじょうぶです。</td>
      <td class="cn-col">不，沒關係。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('また いらっしゃってください。')">また いらっしゃってください。</td>
      <td class="cn-col">歡迎再來。</td>
      <td class="jp jp-col" onclick="speakJP('また いらっしゃってください。')">また いらっしゃってください。</td>
      <td class="cn-col">歡迎再來。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('お元気ですか。')">お元気ですか。</td>
      <td class="cn-col">你好嗎？</td>
      <td class="jp jp-col" onclick="speakJP('お元気ですか。')">お元気ですか。</td>
      <td class="cn-col">你好嗎？</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('そうですね。')">そうですね。</td>
      <td class="cn-col">嗯。/ 對啊。</td>
      <td class="jp jp-col" onclick="speakJP('そうですね、 むずかしい もんだいですね。')">そうですね、 むずかしい もんだいですね。</td>
      <td class="cn-col">嗯，真是個難題呢。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('シャンハイ')">シャンハイ</td>
      <td class="cn-col">上海</td>
      <td class="jp jp-col" onclick="speakJP('いつか シャンハイへ いきたいです。')">いつか シャンハイへ いきたいです。</td>
      <td class="cn-col">總有一天想去上海。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('きんかくじ')"><ruby><rb>金閣寺</rb><rt>きんかくじ</rt></ruby></td>
      <td class="cn-col">金閣寺</td>
      <td class="jp jp-col" onclick="speakJP('きんかくじは とても きれいです。')">きんかくじは とても きれいです。</td>
      <td class="cn-col">金閣寺非常漂亮。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('ならこうえん')"><ruby><rb>奈良公園</rb><rt>ならこうえん</rt></ruby></td>
      <td class="cn-col">奈良公園</td>
      <td class="jp jp-col" onclick="speakJP('ならこうえんで しかを みました。')">ならこうえんで しかを みました。</td>
      <td class="cn-col">在奈良公園看到了鹿。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('ふじさん')"><ruby><rb>富士山</rb><rt>ふじさん</rt></ruby></td>
      <td class="cn-col">富士山（日本最高的山）</td>
      <td class="jp jp-col" onclick="speakJP('ふじさんは にほんで いちばん たかい やまです。')">ふじさんは にほんで いちばん たかい やまです。</td>
      <td class="cn-col">富士山是日本最高的山。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('しちにんのさむらい')">「<ruby><rb>七人</rb><rt>しちにん</rt></ruby>の<ruby><rb>侍</rb><rt>さむらい</rt></ruby>」</td>
      <td class="cn-col">《七武士》（黑澤明導演）</td>
      <td class="jp jp-col" onclick="speakJP('『しちにんのさむらい』を みました。')">『しちにんのさむらい』を みました。</td>
      <td class="cn-col">看了《七武士》。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('にぎやか')">にぎやか</td>
      <td class="cn-col">熱鬧</td>
      <td class="jp jp-col" onclick="speakJP('まちは にぎやかです。')">まちは にぎやかです。</td>
      <td class="cn-col">城市很熱鬧。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('すてき')">すてき</td>
      <td class="cn-col">非常好、棒</td>
      <td class="jp jp-col" onclick="speakJP('すてきな プレゼントですね。')">すてきな プレゼントですね。</td>
      <td class="cn-col">真是個很棒的禮物呢。</td>
    </tr>

    <tr>
      <td class="jp jp-col" onclick="speakJP('レストラン')">レストラン</td>
      <td class="cn-col">餐廳</td>
      <td class="jp jp-col" onclick="speakJP('レストランで ばんごはんを たべます。')">レストランで ばんごはんを たべます。</td>
      <td class="cn-col">在餐廳吃晚餐。</td>
    </tr>
  </table>

  <div class="button-home">
    <a href="index.html">回首頁 🏠</a>
  </div>

  <script>
  let voicesLoaded = false;

  // 偏好 keys
  const KANA_KEY = 'showKana';
  const RATE_KEY = 'ttsRate';
  const VOL_KEY  = 'ttsVolume';
  const MODE_KEY = 'practiceMode'; // 'both' | 'cn' | 'jp'

  function getRate()  { const r = parseFloat(localStorage.getItem(RATE_KEY) ?? '1'); return isNaN(r) ? 1 : r; }
  function getVolume(){ const v = parseFloat(localStorage.getItem(VOL_KEY) ?? '1'); return isNaN(v) ? 1 : v; }

  function speakJP(text) {
    if (!voicesLoaded) {
      window.speechSynthesis.onvoiceschanged = () => { voicesLoaded = true; speakJP(text); };
      speechSynthesis.getVoices();
      return;
    }
    speechSynthesis.cancel();
    const u = new SpeechSynthesisUtterance(text);
    u.lang = 'ja-JP';
    u.rate = getRate();
    u.volume = getVolume();
    const jpVoice = speechSynthesis.getVoices().find(v => v.lang === 'ja-JP');
    if (jpVoice) u.voice = jpVoice;
    speechSynthesis.speak(u);
  }

  // 假名切換
  function applyKanaPreference(show) {
    document.body.classList.toggle('hide-kana', !show);
    const toggle = document.getElementById('kanaToggle');
    if (toggle) toggle.checked = show;
  }

  // 練習模式（顯示全部 / 日→中 / 中→日）
  function applyPracticeMode(mode) {
    document.body.classList.remove('mode-cn','mode-jp');
    if (mode === 'cn') document.body.classList.add('mode-cn'); // 隱藏中文欄
    if (mode === 'jp') document.body.classList.add('mode-jp'); // 隱藏日文欄
    document.querySelectorAll('#modeSeg button').forEach(btn => {
      const active = btn.dataset.mode === mode;
      btn.classList.toggle('active', active);
      btn.setAttribute('aria-selected', String(active));
    });
  }

  // 即時搜尋
  function setupSearch() {
    const input = document.getElementById('searchInput');
    const table = document.getElementById('vocabTable');
    const rows = Array.from(table.querySelectorAll('tr')).slice(1);
    input.addEventListener('input', () => {
      const q = input.value.trim().toLowerCase();
      rows.forEach(tr => {
        const hit = tr.textContent.toLowerCase().includes(q);
        tr.style.display = hit ? '' : 'none';
      });
    });
  }

  document.addEventListener('DOMContentLoaded', () => {
    // 語音初始化
    const checkVoices = () => {
      if (speechSynthesis.getVoices().length > 0) { voicesLoaded = true; }
      else { setTimeout(checkVoices, 120); }
    };
    checkVoices();

    // 假名偏好
    const savedKana = localStorage.getItem(KANA_KEY);
    const showKana = savedKana === null ? true : savedKana === 'true';
    applyKanaPreference(showKana);
    document.getElementById('kanaToggle').addEventListener('change', e => {
      const show = e.target.checked;
      applyKanaPreference(show);
      localStorage.setItem(KANA_KEY, String(show));
    });

    // 朗讀偏好
    const rateEl = document.getElementById('rate');
    const volEl  = document.getElementById('volume');
    rateEl.value = String(getRate());
    volEl.value  = String(getVolume());
    rateEl.addEventListener('input', () => localStorage.setItem(RATE_KEY, rateEl.value));
    volEl.addEventListener('input',  () => localStorage.setItem(VOL_KEY,  volEl.value));

    // 練習模式
    const savedMode = localStorage.getItem(MODE_KEY) ?? 'both';
    applyPracticeMode(savedMode);
    document.querySelectorAll('#modeSeg button').forEach(btn => {
      btn.addEventListener('click', () => {
        const mode = btn.dataset.mode;
        applyPracticeMode(mode);
        localStorage.setItem(MODE_KEY, mode);
      });
    });

    // 搜尋
    setupSearch();
  });
  </script>
</body>
</html>
